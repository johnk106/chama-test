{%extends 'chamas/base.html'%}
{%load static%}
{%load humanize%}


{%block head%}

<title>Members</title>
<link rel="stylesheet" href="{%static 'chamas/members.css'%}">
{%endblock%}



{%block body%}
<div class="modern-members">
    <!-- Mobile View -->
    <div class="mobile-members d-block d-lg-none">
        <div class="mobile-members-header">
            <h4 class="fw-semibold">All Members</h4>
            <div class="alert alert-warning" role="alert" style="display: none;">
                Member removed successfully from chama!
            </div>
            <div class="alert alert-success" role="alert" style="display: none;">
                Member added successfully to chama!
            </div>
            <div class="alert alert-danger" role="alert" style="display: none;">
                You cannot remove the creator from the group!
            </div>
        </div>
        
        <div class="mobile-members-list">
            {%for member in members%}
            <div class="member-beautiful-card" data-member-id="{{ member.id }}" onclick="openMemberModal({{ member.id }})">
                <div class="member-card-header">
                    <div class="member-avatar">
                        {%if member.profile%}
                        <img src="{{member.profile.url}}" alt="{{ member.name }}">
                        {%else%}
                        <img src="data:image/png;base64,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" alt="Default Avatar">
                        {%endif%}
                    </div>
                    <div class="member-info">
                        <h6 class="member-name">{{member.name}}</h6>
                        <span class="member-role {{member.role.name}}-bulb">{{member.role.name}}</span>
                    </div>
                    <div class="member-stats">
                        <i class='bx bx-chevron-right'></i>
                    </div>
                </div>
                <div class="member-summary">
                    <div class="stat-item">
                        <span class="stat-label">Contributions</span>
                        <span class="stat-value">Ksh {{member.total_contributions | intcomma}}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Loans</span>
                        <span class="stat-value">{{member.total_loans}}</span>
                    </div>
                </div>
            </div>
            {%endfor%}
            
            <div class="add-member-mobile-button admin" data-bs-toggle="modal" data-bs-target="#exampleModal">
                <div class="add-member-content">
                    <div class="add-icon">
                        <i class="fa-solid fa-plus"></i>
                    </div>
                    <div class="add-text">
                        <h6>Add New Member</h6>
                        <p>Invite someone to join this chama</p>
                    </div>
                    <div class="arrow-icon">
                        <i class='bx bx-chevron-right'></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Desktop View (unchanged) -->
    <div class="desktop-members d-none d-lg-block">
        <br>
        <div class="row justify-content-center">
            <div class="col-md-6 secs pt-4 mb-4">
                <h4 class="fw-semibold">All Members</h4>
                <div class="alert alert-warning" role="alert" style="display: none;">
                    Member removed successfully from chama!
                </div>
                <div class="alert alert-success" role="alert" style="display: none;">
                    Member added successfully to chama!
                </div>
                <div class="alert alert-danger" role="alert" style="display: none;">
                    You cannot remove the creator from the group!
                </div>
                {%for member in members%}
                <p id="member-id" style="display: none;">{{member.id}}</p>
                <div class="row member-card p-2" data-member-id="{{ member.id }}">

                    {%if member.profile%}
                        <div class="col-lg-2 col-md-12">
                            <img class="dp" style="background:transparent;" src="{{member.profile.url}}" alt="">
                        </div>
                    {%else%}
                        <div class="col-lg-2 col-md-12">
                            <img class="dp"
                                src="data:image/png;base64,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"
                                width="90%" height="90%" alt="">

                        </div>
                    {%endif%}

                    <div class="col-lg-5 col-md-12 ">
                        <p class="fw-semibold text-capitalize">{{member.name}} &nbsp<span id="{{member.role.name}}">{{member.role.name}}</span></p>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="d-flex align-items-center">
                                    <i class="bx bx-envelope"></i> <!-- Email icon -->
                                    <p class="ms-2">{{member.email}}</p> <!-- Email address -->
                                </div>
                            </div>
                        </div>
                        <p>Total Contribution:<span class="contribution-amount">Ksh {{member.total_contributions | intcomma}}</span></p>

                    </div>
                    <div class="col-lg-4 col-md-12">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="d-flex align-items-center">
                                    <i class="fa-solid fa-phone"></i> <!-- Email icon -->
                                    <p class="ms-2">{{member.mobile}}</p> <!-- Email address -->
                                </div>
                            </div>
                        </div>
                        <p>Total Loans:<span class="contribution-amount">{{member.total_loans}}</span></p>



                    </div>
                </div>
                {%endfor%}


            <div id="add-member-button" class="add-member-button" type="button" class="btn btn-primary" data-bs-toggle="modal"
                data-bs-target="#exampleModal">
                <div class="add-member-button-header" id="add-member-button-header">
                    <h6><i class="fa-solid fa-plus"></i> Add Member</h6>
                </div>
            </div>
        </div>

        <div class="col-md-5 secs">
            <div class="profile-image-parent">
                <div class="circular-image" 
                ></div>
                &nbsp;
                <h6 id="member-name"></h6>
                <p id="member-since"></p>
            </div>

            <div class="name-section">
                <h6>Member Name</h6>
                <p id="member-name-2"></p>
            </div>

            <div class="contact-section">
                <h6>Contact</h6>
                <p id="contact"></p>
            </div>

            <div class="role-section text-capitalize">
                <h6 class="d-inline"><i class="fa-solid fa-user-shield"></i> Assigned Role</h6>
                <p class="btn btn-warning btn-sm d-inline fw-semibold" style="color: green;" id="assigned-role"></p>
            </div>

            <div class="contribution-section">
                <div class="contribution-section-header" id="contribution-header">
                    <h6><i class="fa-solid fa-sack-dollar"></i> Contributions</h6>
                    <i class="fa-solid fa-caret-down"></i>

                </div>
                &nbsp;
                <div id="member-contributions" class="member-contributions">

                    <div class="contribution-item">
                        <div class="row">
                            <div class="col-md-3">
                                <label for="date">Date</label>
                                <input type="text" value="1/3/2024" id="date" readonly>

                            </div>

                            <div class="col-md-3 ">
                                <label for="type">Type</label>
                                <input type="text" value="monthly" id="type" readonly>

                            </div>

                            <div class="col-md-3">
                                <label for="target">Target</label>
                                <input type="text" value="ksh 2000" id="target" readonly>

                            </div>

                            <div class="col-md-3">
                                <label for="amount">Amount</label>
                                <input type="text" id="amount" value="ksh 2000" readonly>

                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="loan-section">
                <div class="loan-section-header" id="loan-header">
                    <h6><i class="fa-solid fa-dollar-sign"></i> Loan History</h6>
                    <i class="fa-solid fa-caret-down"></i>
                </div>
                &nbsp;

                <div id="member-loans" class="member-loans">
                    <div class="loan-item">
                        <div class="row">
                            <div class="col-md-3">
                                <label for="loan-amount">Loan amount</label>
                                <input type="text" value="ksh 2000" id="loan-amount" readonly>

                            </div>

                            <div class="col-md-3 ">
                                <label for="intrest">Intrest rate</label>
                                <input type="text" value="5%" id="intrest" readonly>

                            </div>

                            <div class="col-md-3">
                                <label for="date">Start date</label>
                                <input type="text" value="30/1/2024" id="date" readonly>

                            </div>

                            <div class="col-md-3">
                                <label for="end-date">end date</label>
                                <input type="text" id="end-date" value="1/3/2024" readonly>

                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <label for="balance">Loan Balance</label>
                                <input type="text" value="ksh 1500" id="balance" readonly>

                            </div>
                            <div class="col-md-4">
                                <label for="periodic">Periodic Payment</label>
                                <input type="text" value="ksh 500" id="periodic" readonly>

                            </div>
                            <div class="col-md-4">
                                <label for="due-date">Payment due date</label>
                                <input type="text" value="25/2/2024" id="due-date" readonly>

                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <label for="total-paid">Total Paid</label>
                                <input type="text" value="ksh 1500" id="total-paid" readonly>

                            </div>
                            <div class="col-md-4">
                                <label for="next-due-amount">Next Due Payment</label>
                                <input type="text" value="sh 500" id="next-due-amount" readonly>

                            </div>
                            <div class="col-md-4">
                                <label for="date-next">Date of next due</label>
                                <input type="text" value="25/2/2024" id="date-next" readonly>

                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <label for="grace-period">Grace Period</label>
                                <input type="text" value="2 days" id="grace-period" readonly>

                            </div>
                            <div class="col-md-4">
                                <label for="late-payment">Late payment fine</label>
                                <input type="text" value="ksh 1000" id="late-payment" readonly>

                            </div>
                            <div class="col-md-4">
                                <label for="fine-applied-on">Fine Applied on</label>
                                <input type="text" value="10/1/2024" id="balance" readonly>

                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="fine-section">
                <div class="fine-section-header" id="fine-header">
                    <h6><i class="fa fa-light fa-money-bill"></i> Fine History</h6>
                    <i class="fa-solid fa-caret-down"></i>
                </div>
                &nbsp;

                <div id="member-fines" class="member-fines">
                    <div class="fine-item">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="loan-amount">Loan Amount</label>
                                <input type="text" value="ksh 2000" id="loan-amount" readonly>

                            </div>

                            <div class="col-md-6">
                                <label for="loan-balance">Loan Balance</label>
                                <input type="text" value="ksh 1500" id="loan-balance" readonly>

                            </div>


                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <label for="total-contributions">Total Contributions</label>
                                <input type="text" value="ksh 1500" id="total-contributions" readonly>
                            </div>
                            <div class="col-md-6">
                                <label for="next-due-date">Next Due Date</label>
                                <input type="text" value="25/2/2024" id="next-due-date" readonly>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <label for="fine-amount">Fine Amount</label>
                                <input type="text" value="ksh 1000" id="fine-amount" readonly>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <a href="" id="remove-user" style="text-decoration: none;" class="admin">
                <div class="remove-user-button">
                    <div class="remove-user-button-header" id="remove-user-button-header">
                        <h6><i class="fa-solid fa-user-slash"></i> Remove User</h6>
                    </div>
                </div>
            </a>



        </div>
    </div>

</div>

<script src="{% static 'chamas/members.js' %}"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>

    function formatHumanDate(dateString) {
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        const formattedDate = new Date(dateString).toLocaleDateString(undefined, options);
        return formattedDate;
    }

    function removeMemberFromChama() {
        var groupId = localStorage.getItem('groupId');
        var removeButton = $('#remove-user');
        var successAlert = $('.alert-success');
        var errorAlert = $('.alert-danger');

        removeButton.click(function (event) {
            event.preventDefault(); // Prevent the default behavior of the anchor link

            var confirmRemove = confirm('Are you sure you want to remove this member from the chama?');
            if (!confirmRemove) {
                return;
            }

            $.ajax({
                type: 'GET',
                url: removeButton.attr('href'),
                success: function (response) {
                    if (response.status === 'success') {
                        // Show success message
                        successAlert.text(response.message).show();
                        errorAlert.hide();

                        // Remove the member from the UI using the received member_id
                        var memberId = response.member_id;
                        $('.member-card[data-member-id="' + memberId + '"]').remove();
                    } else {
                        // Show error message
                        errorAlert.text(response.message).show();
                        successAlert.hide();
                    }
                },
                error: function () {
                    // Show generic error message
                    errorAlert.text('An error occurred. Please try again.').show();
                    successAlert.hide();
                }
            });
        });
    }

    $(document).ready(function () {
        // Call removeMemberFromChama only once when the document is ready
        removeMemberFromChama();

        displayMemberDetails($('.member-card:first').data('member-id'));

        $('.member-card').on('click', function () {
            var memberId = $(this).data('member-id');
            displayMemberDetails(memberId);
        });

        function displayMemberDetails(memberId) {
            $.ajax({
                url: `/chamas-bookeeping/member-detail/${memberId}/${localStorage.getItem('groupId')}`,
                type: 'GET',
                success: function (response) {
                    if (response.status === 'success') {
                        var member = response.member;
                        var profilePicture = member.profile;
                        var contributions = response.contributions;
                        var loans = response.loans;
                        var fines = response.fines;

                        $('#member-name').text(member.name);
                        $('#member-name-2').text(member.name);
                        $('#member-since').text(`Member since ${formatHumanDate(member.member_since)}`);
                        $('#assigned-role').text(member.role);
                        $('#assigned-role').addClass(`${member.role}-bulb`);
                        $('#contact').text(member.mobile);
                        $('#remove-user').attr('href', `/chamas-bookeeping/remove-member-from-chama/${member.id}/${localStorage.getItem('groupId')}/`);
                         // Get profile picture URL

                        // Set profile picture dynamically
                        if (profilePicture) {
                            $('.circular-image').css('background-image', `url('${profilePicture}')`);
                        } else {
                            // If profile picture is null, set a default background color or image
                            $('.circular-image').css('background-image', `url('data:image/png;base64,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')`);// Example color
                        }
                        // Display contributions
                        var contributionList = $('#member-contributions');
                        contributionList.empty();
                        contributions.forEach(function (contribution) {
                            var contributionItem = $('<div>').addClass('contribution-item');
                            contributionItem.append(`<div class="row">
                            <div class="col-md-3">
                                <label for="date">Date</label>
                                <input type="text" value="${contribution.date_created}" id="date" readonly>
                            </div>
                            <div class="col-md-3 ">
                                <label for="type">Type</label>
                                <input type="text" value="${contribution.contribution}" id="type" readonly>
                            </div>
                            <div class="col-md-3">
                                <label for="target">Target</label>
                                <input type="text" value="${contribution.amount_expected}" id="target" readonly>
                            </div>
                            <div class="col-md-3">
                                <label for="amount">Amount</label>
                                <input type="text" id="amount" value="${contribution.amount_paid}" readonly>
                            </div>
                        </div>`);
                            contributionList.append(contributionItem);
                        });

                        // Display loans
                        var loanList = $('#member-loans');
                        loanList.empty();
                        loans.forEach(function (loan) {
                            var loanItem = $('<div>').addClass('loan-item');
                            loanItem.append(`<div class="row">
                            <div class="col-md-3">
                                <label for="loan-amount">Loan amount</label>
                                <input type="text" value="${loan.amount}" id="loan-amount" readonly>
                            </div>
                            <div class="col-md-3 ">
                                <label for="intrest">Intrest rate</label>
                                <input type="text" value="${loan.intrest_rate}" id="intrest" readonly>
                            </div>
                            <div class="col-md-3">
                                <label for="date">Start date</label>
                                <input type="text" value="${loan.start_date}" id="date" readonly>
                            </div>
                            <div class="col-md-3">
                                <label for="end-date">End date</label>
                                <input type="text" id="end-date" value="${loan.end_date}" readonly>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <label for="balance">Loan Balance</label>
                                <input type="text" value="${loan.balance}" id="balance" readonly>
                            </div>
                            <div class="col-md-3">
                                <label for="periodic">Periodic Payment</label>
                                <input type="text" value="${loan.total_paid}" id="periodic" readonly>
                            </div>
                            <div class="col-md-3">
                                <label for="due-date">Payment due date</label>
                                <input type="text" value="${loan.end_date}" id="due-date" readonly>
                            </div>
                            <div class="col-md-3">
                                <label for="grace-period">Grace Period</label>
                                <input type="text" value="${loan.grace_period}" id="grace-period" readonly>
                            </div>
                        </div>`);
                            loanList.append(loanItem);
                        });

                        // Display fines
                        var fineList = $('#member-fines');
                        fineList.empty();
                        fines.forEach(function (fine) {
                            var fineItem = $('<div>').addClass('fine-item');
                            fineItem.append(`<div class="row">
                            <div class="col-md-6">
                                <label for="loan-amount">Fine Type</label>
                                <input type="text" value="${fine.fine_type}" id="loan-amount" readonly>
                            </div>
                            <div class="col-md-6">
                                <label for="loan-balance">Fine status</label>
                                <input type="text" value="${fine.status}" id="loan-balance" readonly>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="total-contributions">fine amount</label>
                                <input type="text" value="${fine.fine_amount}" id="total-contributions" readonly>
                            </div>
                            <div class="col-md-6">
                                <label for="next-due-date">Paid Fine amount</label>
                                <input type="text" value="${fine.paid_fine_amount}" id="next-due-date" readonly>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <label for="fine-amount">Last Updated</label>
                                <input type="text" value="${fine.last_updated}" id="fine-amount" readonly>
                            </div>
                        </div>`);
                            fineList.append(fineItem);
                        });
                    } else {
                        console.error('Failed to fetch member details:', response.message);
                    }
                },
                error: function (xhr, status, error) {
                    console.error('AJAX request failed:', status, error);
                }
            });
        }

    });
</script>

<!-- Member Detail Modal -->
<div class="member-detail-modal" id="memberModal">
    <div class="modal-backdrop" onclick="closeMemberModal()"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">Member Details</h5>
            <button class="modal-close-btn" onclick="closeMemberModal()">
                <i class='bx bx-x'></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="member-profile-section">
                <div class="member-profile-img" id="modalMemberAvatar"></div>
                <div class="member-basic-info">
                    <h6 id="modalMemberName"></h6>
                    <span class="member-role-badge" id="modalMemberRole"></span>
                    <p class="member-since" id="modalMemberSince"></p>
                </div>
            </div>
            
            <div class="member-contact-section">
                <div class="contact-item">
                    <i class='bx bx-envelope'></i>
                    <span id="modalMemberEmail"></span>
                </div>
                <div class="contact-item">
                    <i class='bx bx-phone'></i>
                    <span id="modalMemberPhone"></span>
                </div>
            </div>
            
            <div class="member-stats-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class='bx bx-money'></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="modalTotalContributions"></span>
                            <span class="stat-label">Total Contributions</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class='bx bx-credit-card'></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="modalTotalLoans"></span>
                            <span class="stat-label">Total Loans</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="member-details-section">
                <div class="detail-tabs">
                    <button class="detail-tab-btn active" data-tab="contributions">Contributions</button>
                    <button class="detail-tab-btn" data-tab="loans">Loans</button>
                    <button class="detail-tab-btn" data-tab="fines">Fines</button>
                </div>
                
                <div class="detail-tab-content active" id="contributions-tab">
                    <div id="modalContributions" class="contributions-list"></div>
                </div>
                
                <div class="detail-tab-content" id="loans-tab">
                    <div id="modalLoans" class="loans-list"></div>
                </div>
                
                <div class="detail-tab-content" id="fines-tab">
                    <div id="modalFines" class="fines-list"></div>
                </div>
            </div>
            
            <div class="admin-actions admin" id="adminActions">
                <button class="remove-member-btn admin" id="modalRemoveMember">
                    <i class='bx bx-user-minus'></i>
                    Remove Member
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// Mobile member modal functionality
function openMemberModal(memberId) {
    const modal = document.getElementById('memberModal');
    modal.style.display = 'flex';
    modal.classList.add('show');
    document.body.classList.add('modal-open');
    document.body.style.overflow = 'hidden';
    
    // Fetch member details
    $.ajax({
        url: `/chamas-bookeeping/member-detail/${memberId}/${localStorage.getItem('groupId')}`,
        type: 'GET',
        success: function (response) {
            if (response.status === 'success') {
                populateMemberModal(response);
            } else {
                console.error('Failed to fetch member details:', response.message);
                closeMemberModal();
            }
        },
        error: function (xhr, status, error) {
            console.error('AJAX request failed:', status, error);
            closeMemberModal();
        }
    });
}

function closeMemberModal() {
    const modal = document.getElementById('memberModal');
    modal.classList.remove('show');
    document.body.classList.remove('modal-open');
    document.body.style.overflow = 'auto';
    
    // Hide modal after transition
    setTimeout(() => {
        modal.style.display = 'none';
    }, 300);
}

function populateMemberModal(response) {
    const member = response.member;
    const contributions = response.contributions;
    const loans = response.loans;
    const fines = response.fines;
    
    // Basic info
    document.getElementById('modalMemberName').textContent = member.name;
    document.getElementById('modalMemberRole').textContent = member.role;
    document.getElementById('modalMemberRole').className = 'member-role-badge ' + member.role + '-bulb';
    document.getElementById('modalMemberSince').textContent = `Member since ${formatHumanDate(member.member_since)}`;
    document.getElementById('modalMemberEmail').textContent = member.email;
    document.getElementById('modalMemberPhone').textContent = member.mobile;
    document.getElementById('modalTotalContributions').textContent = 'Ksh ' + new Intl.NumberFormat().format(member.total_contributions);
    document.getElementById('modalTotalLoans').textContent = member.total_loans;
    
    // Avatar
    const avatar = document.getElementById('modalMemberAvatar');
    if (member.profile) {
        avatar.style.backgroundImage = `url('${member.profile}')`;
    } else {
        avatar.style.backgroundImage = `url('data:image/png;base64,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')`;
    }
    
    // Populate contributions
    populateContributions(contributions);
    
    // Populate loans
    populateLoans(loans);
    
    // Populate fines
    populateFines(fines);
    
    // Setup remove member button
    document.getElementById('modalRemoveMember').onclick = function() {
        if (confirm('Are you sure you want to remove this member?')) {
            window.location.href = `/chamas-bookeeping/remove-member-from-chama/${member.id}/${localStorage.getItem('groupId')}/`;
        }
    };
}

function populateContributions(contributions) {
    const container = document.getElementById('modalContributions');
    container.innerHTML = '';
    
    if (contributions.length === 0) {
        container.innerHTML = '<div class="no-data"><i class="bx bx-inbox"></i><p>No contributions found</p></div>';
        return;
    }
    
    contributions.forEach(contribution => {
        const item = document.createElement('div');
        item.className = 'detail-item';
        item.innerHTML = `
            <div class="detail-row">
                <span class="detail-label">Date</span>
                <span class="detail-value">${contribution.date_created}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Type</span>
                <span class="detail-value">${contribution.contribution}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Expected</span>
                <span class="detail-value">${contribution.amount_expected}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Paid</span>
                <span class="detail-value success">${contribution.amount_paid}</span>
            </div>
        `;
        container.appendChild(item);
    });
}

function populateLoans(loans) {
    const container = document.getElementById('modalLoans');
    container.innerHTML = '';
    
    if (loans.length === 0) {
        container.innerHTML = '<div class="no-data"><i class="bx bx-inbox"></i><p>No loans found</p></div>';
        return;
    }
    
    loans.forEach(loan => {
        const item = document.createElement('div');
        item.className = 'detail-item';
        item.innerHTML = `
            <div class="detail-row">
                <span class="detail-label">Amount</span>
                <span class="detail-value">${loan.amount}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Interest Rate</span>
                <span class="detail-value">${loan.intrest_rate}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Balance</span>
                <span class="detail-value warning">${loan.balance}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Start Date</span>
                <span class="detail-value">${loan.start_date}</span>
            </div>
        `;
        container.appendChild(item);
    });
}

function populateFines(fines) {
    const container = document.getElementById('modalFines');
    container.innerHTML = '';
    
    if (fines.length === 0) {
        container.innerHTML = '<div class="no-data"><i class="bx bx-inbox"></i><p>No fines found</p></div>';
        return;
    }
    
    fines.forEach(fine => {
        const item = document.createElement('div');
        item.className = 'detail-item';
        item.innerHTML = `
            <div class="detail-row">
                <span class="detail-label">Type</span>
                <span class="detail-value">${fine.fine_type}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Amount</span>
                <span class="detail-value danger">${fine.fine_amount}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Paid</span>
                <span class="detail-value">${fine.paid_fine_amount}</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Status</span>
                <span class="detail-value">${fine.status}</span>
            </div>
        `;
        container.appendChild(item);
    });
}

// Detail tabs functionality
document.addEventListener('DOMContentLoaded', function() {
    const tabButtons = document.querySelectorAll('.detail-tab-btn');
    const tabContents = document.querySelectorAll('.detail-tab-content');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', function() {
            const targetTab = this.dataset.tab;
            
            // Remove active class from all buttons and contents
            tabButtons.forEach(btn => btn.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked button and corresponding content
            this.classList.add('active');
            document.getElementById(targetTab + '-tab').classList.add('active');
        });
    });
});
</script>

{%endblock%}